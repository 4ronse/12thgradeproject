<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
        integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w=="
        crossorigin="anonymous" />


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>

    <script src="https://kit.fontawesome.com/252cab516b.js" crossorigin="anonymous"></script>

    <style>
        .row {
            min-height: 6rem;

        }

        #custom-context-menu {
            position: fixed;
            z-index: 9999999;

            width: 18rem;

            padding: 3px;

            background-color: #212529;

            transform: scale(0);
            transform-origin: top left;
            transition: 0.1s ease-in-out;
        }

        #custom-context-menu.active {
            transform: scale(1);
            transition: 0.1s ease-in-out;
        }

        #custom-context-menu > .context-menu-item {
            padding: 0.2rem 0.5rem;
            font-size: 1.2rem;
            color: #E1E1E1FF;
        }

        #custom-context-menu > .context-menu-item:last-child {
            padding: 0.2rem 0.5rem 0;
        }

        #custom-context-menu > .context-menu-item:hover {
            background: rgba(199, 212, 222, 0.49);
        }

        #custom-context-menu > .context-menu-item i {
            display: inline-block;
            margin-right: 0.4rem;
        }
    </style>

    <script>

        class ContextMenu {
            #self;
            #items;

            constructor(items) {
                items.forEach(item => {
                    if(item instanceof ContextMenuItem) return;

                    console.assert(item.hasOwnProperty('onclick'), 'Item must have an `onclick` property, EVEN IF IS `null`!');
                    console.assert(item.hasOwnProperty('icon'), 'Item must have an `icon` property, EVEN IF IS `null`!')
                    console.assert(item.hasOwnProperty('text'), 'Item must have a `text` property');

                    console.assert(item['text'] !== null && item['text'].length > 0, 'Item text MUST NOT BE EMPTY');
                    console.assert(item['icon'].hasOwnProperty('style') && item['icon'].hasOwnProperty('name'), 'Item icon must have the `style` and the `name` properties!');
                });

                this.#items = items;
                this.#self = null;
            }

            createContextMenu(id='custom-context-menu', classList = []) {
                console.assert(this.#self === null, 'Instance already exists!');

                let contextMenu = document.createElement('div');
                this.#self = contextMenu;
                contextMenu.id = id;
                if(classList.length > 0) contextMenu.classList.add(classList);

                this.#items.forEach(item => {
                    if(item.hasOwnProperty('createItem')) return contextMenu.appendChild(item.createItem());

                    item = new ContextMenuItem(item['text'], item['icon']['name'], item['icon']['style'], item['onclick']);
                    contextMenu.appendChild(item.createItem());
                });

                return [this, contextMenu];
            }

            addContextMenuToScreen() {
                const contextMenu = this.#self;

                document.addEventListener('contextmenu', (e) => {
                    if(e.composedPath().includes(contextMenu)) return;
                    e.preventDefault();

                    let offsetX = e.offsetX;
                    let offsetY = e.offsetY;

                    if(offsetX + contextMenu.offsetWidth > window.innerWidth) offsetX = window.innerWidth - contextMenu.offsetWidth;
                    if(offsetY + contextMenu.offsetHeight > window.innerHeight) offsetY = window.innerHeight - contextMenu.offsetHeight;

                    contextMenu.style.top = offsetY + 'px';
                    contextMenu.style.left = offsetX + 'px';

                    contextMenu.classList.add('active');
                });

                document.addEventListener('click', (e) => {
                    if(e.composedPath().includes(contextMenu)) return;
                    contextMenu.classList.remove('active');
                })

                document.body.appendChild(contextMenu);
            }

            add(item) {
                this.#self.appendChild(item.createItem());
            }
        }

        class ContextMenuItem {
            #text
            #icon
            #onclick
            #div;
            #i;
            #span;

            constructor(text, iconName, iconStyle, onclick = ()=>{}) {
                this.#div = document.createElement('div');
                this.#i = document.createElement('i');
                this.#span = document.createElement('span');

                this.setText(text);
                this.setIcon({'name': iconName, 'style': iconStyle});
                this.setOnClick(onclick);
            }

            setText(text) {
                this.#text = text;
                this.#span.innerText = text;
            }

            setIcon(icon) {
                if(this.#icon !== undefined) this.#i.classList.remove(this.#icon['name'], this.#icon['style']);
                this.#i.classList.add(icon['name'], icon['style']);

                this.#icon = icon;
            }

            setOnClick(onClick) {
                this.#div.removeEventListener('click', this.#onclick);

                this.#onclick = onClick;
                this.#div.addEventListener('click', onClick);
            }

            createItem() {
                let div = this.#div;
                let i = this.#i;
                let span = this.#span;

                div.classList.add('context-menu-item');
                div.append(i, span);

                return div;
            }

            get onclick() {
                return this.#onclick;
            }

            get icon() {
                return this.#icon;
            }

            get text() {
                return this.#text;
            }
        }

        let sus = new ContextMenuItem('imposta', 'fa-suse', 'fab', () => console.log('lol'));

        const menu = new ContextMenu([
            {
                'text': 'sus',
                'icon': {
                    'style': 'fas',
                    'name': 'fa-download'
                },
                'onclick': function(e) {
                    console.log('sus');
                }
            },

            sus
        ]);

        window.addEventListener('load', () => {
            menu.createContextMenu();
            menu.addContextMenuToScreen();
        });

        /*
        window.addEventListener('contextmenu', (e) => {
            e.preventDefault();

            let contextElem = document.getElementById('custom-context-menu');

            console.log(contextElem.getBoundingClientRect())
            if(e.composedPath().includes(contextElem)) return;

            contextElem.style.top = e.offsetY + 'px';
            contextElem.style.left = e.offsetX + 'px';
            contextElem.classList.add('active');
        });

        window.addEventListener('click', (e) => {
            document.getElementById('custom-context-menu').classList.remove('active');
        })

            <div id="custom-context-menu">
        <div class="context-menu-item">
            <i class="fas fa-download"></i>
            <span> Download </span>
        </div>
    </div>
         */

    </script>
</head>

<body>



    <div class="container my-4">
        <div class="row">

            <div class="col-md-3 col-sm-4">
                <div class="card" style="min-width: 18rem;">
                    <div class="card-body">
                        <img src="https://i1.sndcdn.com/artworks-80bW7DEyRSBwV4vZ-zi3z0g-t500x500.jpg"
                            class="card-img-top" alt="" srcset="" style="height: 12rem;">
                        <div class="row mt-2" style="min-height: 1rem !important;">
                            <span class="card-text"
                                style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                amogussus.exesdfgsdfgsdfgsdfgsdfgsdfgsdfgsdfgsdfgsdfgsdfgsdfg
                            </span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</body>

</html>